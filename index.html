
<html>
<head>

  <!--[if lt IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/json3/3.2.4/json3.min.js"></script>
  <![endif]-->
  
  <!-- jQuery -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <!-- XDomain -->
  <script src="dist/xdomain.js"></script>
  <!-- Demo -->
  <script type="text/javascript">


  if(!window.console)
    console = { log: $.noop };

  var slave,
      path = '/example/proxy.html',
      file = '/example/data.json' ;

  (function() {

    console.log(location.origin);

    if(location.origin === 'http://abc.example.com:3000') {
      slave = 'http://xyz.example.com:3000';
    } else if(location.origin === 'http://a.example.com:3000') {
      slave = 'http://b.example.com:3000';
    } else if(location.origin === 'http://xdomain.jpillora.com') {
      slave = 'http://anotherdomain.jpillora.com';
      path = '/proxy.html';
      file = '/data/file1.json' ;
    } else {
      return console.log('demo slave mismatch');
    }

    var slaves = {};
    slaves[slave] = path

    $.xdomain({
      slaves: slaves
    });

  }());

  $(function() {
    $("#hostInput").val(slave);
    $("#pathInput").val(file);

    $("button").click(function() {
      $.get( $('#hostInput').val() + $('#pathInput').val()).always( 
        function(data) {
          $("#output").text(JSON.stringify(data,null,2));
        }
      );
    }).click();
  });
  
  </script>
</head>
<body>

  <h3>XDomain Demo</h3>

  <h4 id="host"></h4>
  <script type="text/javascript">
    document.getElementById('host').innerHTML = window.location.origin;
  </script>

  <h4>Input</h4>
  <div>

    <style>
      input { width: 200px }
    </style>

    <input id='hostInput' type='text' placeholder='host'/>
    <input id='pathInput' type='text' placeholder='host'/>
    <button>GET</button>
  </div>

  <h4>Output</h4>
  <pre id='output'></pre>

</body>
</html>


